---
import { getEntry } from "astro:content";
import Layout from "../../../layouts/App.astro";
import pageTitle from "../../../utils/pageTitle";

const { documentId } = Astro.params;

Astro.cookies.delete(String(documentId), { path: `/dokumenty/${documentId}` });

const info = await getEntry("info", String(documentId));
const document = await getEntry("documents", String(documentId));

if (!info || !document) {
  return Astro.redirect("/404");
}

const { Content } = await info.render();
const { title, index } = document.data;

const firstQuestionUrl = `${Astro.url.origin}/dokumenty/${documentId}/${index[0].questions[0].id.slug}`;
---

<Layout title={pageTitle(title)}>
  <span slot="topbar-title">{title}</span>
  <div>
    <header>
      <h1>{title}</h1>
      <a href={firstQuestionUrl}>Stwórz dokument</a>
    </header>
    <hr />
    <article class="prose">
      <Content />
    </article>
    <footer>
      <a href={firstQuestionUrl}>Stwórz dokument</a>
    </footer>
  </div>
</Layout>

<style>
  div {
    @apply bg-white rounded-lg p-20 sm:p-40 my-20 flex flex-col gap-30;
  }

  header {
    @apply flex items-center gap-15 flex-wrap;
  }

  header h1 {
    @apply flex-grow;
    @apply text-2xl;
  }

  footer a,
  header a {
    @apply btn btn-default btn-big;
  }

  hr {
    @apply border-dark30;
  }

  footer {
    @apply p-20 flex justify-center;
  }

  footer a {
    @apply btn-big;
  }
</style>
